affd 60 `` ``		rts
```` `` `` ``	;
```` `` `` ``	;
```` `` `` ``	;
```` `` `` ``	;
```` `` `` ``	;
affe `` `` ``	keyserv
```` `` `` ``	;		keyboard service routine
affe a5 ca ``		lda	thekey		; any key
b000 f0 3e ``		beq	kesr3		; no
b002 a2 14 ``		ldx	#$14		; last key
b004 85 6a ``		sta	temp
b006 a9 00 ``		lda	#$00
b008 85 66 ``		sta	timout		; reset atract timeout
b00a 85 ca ``		sta	thekey		; turn off key
b00c a9 11 ``		lda	#$11
b00e 8d 1b d0		sta	prior		; reset priority , from starbase
b011 `` `` ``	keysr1
b011 bd be ba		lda	codcon,x		; key codes
b014 c5 6a ``		cmp	temp
b016 f0 08 ``		beq	keysr2
b018 ca `` ``		dex
b019 10 f6 ``		bpl	keysr1		; next key
```` `` `` ``	;			no key
b01b a0 10 ``		ldy	#senwht-sentab		; what
b01d 4c 23 b2		jmp	ldmess
b020 `` `` ``	keysr2			; key found
b020 e0 0a ``		cpx	#$0a		; impulse engine ?
b022 b0 1d ``		bcs	keysr4		; no
b024 a5 c0 ``		lda	hflag		; hwarp ?
b026 f0 03 ``		beq	keys20		; no
b028 4c 80 a9		jmp	habort
b02b `` `` ``	keys20
b02b 2c 93 09		bit	damage+1		; engines
b02e 50 06 ``		bvc	keys23
b030 e0 06 ``		cpx	#$06
b032 90 02 ``		bcc	keys23
b034 a2 05 ``		ldx	#$05
b036 `` `` ``	keys23
b036 bd d3 ba		lda	wentab,x
b039 85 80 ``		sta	wpener		; impulse engine energy
b03b bd b4 ba		lda	warptb,x		; speed
b03e 85 71 ``		sta	warp		; speed desired
b040 `` `` ``	keysr3
b040 60 `` ``		rts
b041 `` `` ``	keysr4
b041 e0 0e ``		cpx	#$0e		; display type key ?
b043 b0 1b ``		bcs	keysr5		; no
```` `` `` ``	;
b045 `` `` ``	keys15		; entry point to init display,  ***********************
```` `` `` ``	;		x must be defined to the key code in codcon
b045 bd 18 8e		lda	distyp-10,x
b048 85 d0 ``		sta	disflg
b04a bc 82 ba		ldy	disdis-10,x
b04d a2 02 ``		ldx	#displ1-disply
b04f a9 08 ``		lda	#$08
b051 20 f1 ad		jsr	ldisp
```` `` `` ``	;
b054 a2 10 ``		ldx	#stlast
b056 `` `` ``	keysr6
